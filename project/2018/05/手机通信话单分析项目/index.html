<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<title>手机通信话单分析项目</title>
<meta name="description" content="一个Flex布局的实例 - Mia Wang">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="short icon" href="/favicon.png">
<link rel="stylesheet" href="/css/apollo.css">
<link rel="stylesheet"
	href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600"
	type="text/css">
</head>
<body>
	<div class="wrap">
		<header>
			<a href="/" class="logo-link"><img src="/favicon.png"></a>
			<ul class="nav nav-list">
				<li class="nav-list-item"><a href="/" target="_self"
					class="nav-list-link active">PROJECT</a></li>
				<li class="nav-list-item"><a href="/archives/" target="_self"
					class="nav-list-link">SKILL</a></li>
				<li class="nav-list-item"><a
					href="https://github.com/Larry-Arun" target="_blank"
					class="nav-list-link">GITHUB</a></li>
				<li class="nav-list-item"><a
					href="https://Larry-Arun.github.io/resume/" target="_blank"
					class="nav-list-link">RESUME</a></li>
				<li class="nav-list-item"><a
					href="https://Larry-Arun.github.io/Tank-World-War" target="_blank"
					class="nav-list-link"></a></li>
			</ul>
		</header>
		<section class="container">
			<div class="post">
				<article class="post-block">
					<h1 class="post-title">手机通信话单分析项目</h1>
					<p>June 8, 2018</p>
					<div class="post-content">
						<a id="more"></a>
						<h3 id="1-属性简介">
							<a href="#1-属性简介" class="headerlink" title="1.属性简介"></a>开发环境
						</h3>
						<p>IDEA+maven+JDK+linux</p>
						<h3 id="1-属性简介">
							<a href="#1-属性简介" class="headerlink" title="1.属性简介"></a>系统架构
						</h3>
						<p>hadoop+zookeeper+flume+ kafka+hbase</p>
						<h3 id="1-属性简介">
							<a href="#1-属性简介" class="headerlink" title="1.属性简介"></a>需求描述
						</h3>
						<p>通信运营商每时每刻会产生大量的通信数据，需要定时定期的对已有数据进行离线的分析处理。例如，当日话单，
							月度话单，季度话单，年度话单，通话次数，通话总时长等等。项目需求就是要满足用户对通信话单的查询和展示。</p>
						<h3 id="2-一个实例">
							<a href="#2-一个实例" class="headerlink" title="2.一个实例"></a>项目描述
						</h3>
						<p>项目一共分为三块，第一部分为数据生产，在这部分要清楚项目数据的结构和内容，预判可能出现的问题并进行数据清洗，
							将数据写入到日志文件中；第二部分是将生产的数据落地到HBase中，首先是用Flume监控日志文件，
							采集实时产生的数据到kafka集群，再调用Kafka和HBase的API，将数据写入到HBase中。
							第三部分是对HBase中采集到的数据进行分析，统计出我们想要的结果，将统计结果写入到MySQL中让用户查询。</p>
						<h3 id="2-一个实例">
							<a href="#2-一个实例" class="headerlink" title="2.一个实例"></a>项目步骤
						</h3>
						<ul>
							<li>数据生产：a) 创建 Java 集合类存放模拟的电话号码和联系人；b)
								随机选取两个手机号码当做“主叫”与“被叫”，产出 call1 与 call2 字段数据；c)
								创建随机生成通话建立时间的方法，产出date_time 字段数据；d) 随机一个通话时长，单位：秒，产出 duration
								字段数据；e) 将产出的一条数据拼接封装到一个字符串中；f)、将通话数据写入到本地文件中；</li>
							<li>数据消费：a) 编写 kafka 消费者，读取 kafka 集群中缓存的消息，并打印
								到控制台以观察是否成功；b)编写调用 HBaseAPI 相关方法，将从 Kafka 
								中读 取出来的数据写入到 HBase ；</li>
							<li>数据分析：a) 按照时间维度来统计通话，比如统计 2017 年所有月份所有日子的通话记录，
							那这个维度我们大概可以表述为 2017 年*月*日。b) 通过 Mapper 将数据按照不同维度聚合给Reducer。
							c) 通过 Reducer 拿到按照各个维 度聚合过来的数据，进行汇总，输出。d) 根据业务需求，
							将Reducer 的输出通 过 Outputformat 把数据输出到MySQL中 。</li>
						</ul>
						<h3 id="3">
							<a
								href="https://github.com/Larry-Arun/ct"
								class="headerlink" target="_blank">项目源码</a>
						</h3>
					</div>
				</article>
			</div>
		</section>
		<footer>
			<div class="paginator">
				<a href="/project/2018/04/HBase项目-微博系统/" class="next">NEXT</a>
				<div class="copyright">
					<p>
						© 2018 - project <a href="https://Larry-Arun.github.io/resume/"
							target="_blank">My Resume</a>
					</p>
				</div>
			</div>
		</footer>
		<script async
			src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
		<script>
			(function(b, o, i, l, e, r) {
				b.GoogleAnalyticsObject = l;
				b[l] || (b[l] = function() {
					(b[l].q = b[l].q || []).push(arguments)
				});
				b[l].l = +new Date;
				e = o.createElement(i);
				r = o.getElementsByTagName(i)[0];
				e.src = '//www.google-analytics.com/analytics.js';
				r.parentNode.insertBefore(e, r)
			}(window, document, 'script', 'ga'));
			ga('create', "UA-65933410-1", 'auto');
			ga('send', 'pageview');
		</script>
	</div>
</body>
</html>