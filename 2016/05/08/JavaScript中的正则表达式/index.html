<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> JavaScript中的正则表达式 · Mia</title><meta name="description" content="JavaScript中的正则表达式 - Mia Wang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/iridescentmia" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://iridescentmia.github.io/resume/" target="_blank" class="nav-list-link">RESUME</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">JavaScript中的正则表达式</h1><div class="post-info">May 8, 2016</div><div class="post-content"><p>最近一直用到正则表达式，今天跟着教程系统学习了一下，整理笔记如下：</p>
<h3 id="1-字符串操作函数"><a href="#1-字符串操作函数" class="headerlink" title="1.字符串操作函数"></a><strong>1.字符串操作函数</strong></h3><ul>
<li>search</li>
<li>substring</li>
<li>charAt</li>
<li>split</li>
</ul>
<p><strong>1.1 search</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">'abcdef'</span>;</span><br><span class="line">alert(str.search(<span class="string">'b'</span>));<span class="comment">//1, 找到则返回所在位置</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">'abcdef'</span>;</span><br><span class="line">alert(str.search(<span class="string">'m'</span>));<span class="comment">//-1, 没找到返回-1</span></span><br></pre></td></tr></table></figure>
<p><strong>1.2 substring</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">'abcdef'</span>;</span><br><span class="line">alert(str.substring(<span class="number">2</span>,<span class="number">4</span>)); <span class="comment">//cd, 返回[2,4)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">'abcdef'</span>;</span><br><span class="line">alert(str.substring(<span class="number">2</span>)); <span class="comment">//cdef, 只提供一个参数时，取到字符串结尾</span></span><br></pre></td></tr></table></figure>
<p><strong>1.3 charAt</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">'abcdef'</span>;</span><br><span class="line">alert(str.charAt(<span class="number">3</span>)); <span class="comment">//d</span></span><br></pre></td></tr></table></figure>
<p><strong>1.4 split</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">'ab-cd-ef'</span>;</span><br><span class="line">alert(str.split(<span class="string">'-'</span>)); <span class="comment">//[ab,cd,ef]</span></span><br></pre></td></tr></table></figure>
<h3 id="2-正则表达式"><a href="#2-正则表达式" class="headerlink" title="2.正则表达式"></a><strong>2.正则表达式</strong></h3><ul>
<li>两种书写方式</li>
<li>标志的介绍</li>
<li>元字符介绍</li>
<li>量词的介绍</li>
<li>方括号介绍</li>
</ul>
<p><strong>2.1 两种书写方式</strong></p>
<ul>
<li>perl风格（字面量形式）：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/[bc]at/i</span>; <span class="comment">// re = /pattern/attributes;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Javascript风格（使用RegExp构造函数定义）：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"[bc]at"</span>,<span class="string">"i"</span>); <span class="comment">// re = new RegExp(pattern, attributes);</span></span><br></pre></td></tr></table></figure>
<p><strong>2.2 标志的介绍</strong></p>
<ul>
<li>i: 不区分大小写模式（case-insensitive）</li>
<li>g: 全局模式（global），不是在发现第一个匹配项时立即停止</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abc 853 isaf98024 sfk'</span>;</span><br><span class="line"><span class="keyword">var</span> re1 = <span class="regexp">/\d/</span>;</span><br><span class="line"><span class="keyword">var</span> re2 = <span class="regexp">/\d/g</span>;</span><br><span class="line">alert(str.match(re1));<span class="comment">//8</span></span><br><span class="line">alert(str.match(re2));<span class="comment">//8,5,3,9,8,0,2,4</span></span><br></pre></td></tr></table></figure>
<p><strong>2.3 元字符介绍</strong></p>
<p><strong>\d</strong> ：匹配数字</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abc 853 isaf98024 sfk9we 98'</span>;</span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/\d/</span>;</span><br><span class="line">alert(str.search(re));<span class="comment">//4 第一个数字出现的位置</span></span><br></pre></td></tr></table></figure>
<p><strong>\D</strong> ：匹配非数字，等价于[^0-9]</p>
<p><strong>\w</strong> ：匹配英文、数字，下划线，等价于[a-z0-9_]</p>
<p><strong>\W</strong> ：匹配除了英文、数字，下划线以外的字符，等价于[^a-z0-9_]</p>
<p><strong>\s</strong> ：匹配空白字符</p>
<p><strong>\S</strong> ：匹配非空白字符</p>
<p><strong>.(点)</strong> ：匹配任意字符，尽量少用</p>
<p><strong>2.4 量词的介绍</strong></p>
<p><strong>{n}</strong> ：正好出现n次</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = \d&#123;<span class="number">8</span>&#125;; <span class="comment">// 匹配连续8位数字</span></span><br></pre></td></tr></table></figure>
<p><strong>{n,m}</strong> ：最少n次，最多m次<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = [<span class="number">1</span><span class="number">-9</span>]\d&#123;<span class="number">4</span>,<span class="number">10</span>&#125;;<span class="comment">//5-11位非0开头的QQ号</span></span><br></pre></td></tr></table></figure></p>
<p><strong>{n,}</strong> ：n最少出现n次，最多次数不限</p>
<p><strong>n+</strong> ：n至少出现一次，等价于{1,}</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abc 853 isaf98024 sfk'</span>;</span><br><span class="line"><span class="keyword">var</span> re1 = <span class="regexp">/\d/g</span>;</span><br><span class="line"><span class="keyword">var</span> re2 = <span class="regexp">/\d+/g</span>;</span><br><span class="line">alert(str.match(re1));<span class="comment">//8,5,3,9,8,0,2,4</span></span><br><span class="line">alert(str.match(re2));<span class="comment">//853,98024</span></span><br></pre></td></tr></table></figure>
<p><strong>n?</strong> ：n出现一次或者不出现，等价于{0,1}<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//电话号码中以0开头的3-4位区号可有可无，和后面非0开头的8位电话号，用-连接</span></span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/(0\d&#123;2,3&#125;-)?[1-9]\d&#123;7&#125;/</span>;</span><br></pre></td></tr></table></figure></p>
<p><strong>n*</strong> ：等价于{0,}，不推荐使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abc 853 isaf98024 sfk'</span>;</span><br><span class="line"><span class="keyword">var</span> re1 = <span class="regexp">/\d+/g</span>;</span><br><span class="line"><span class="keyword">var</span> re2 = <span class="regexp">/\d*/g</span>;</span><br><span class="line">alert(str.match(re1));<span class="comment">//853,9802</span></span><br><span class="line">alert(str.match(re2));<span class="comment">//,,,,853,,,,,,98024,,,,,</span></span><br></pre></td></tr></table></figure>
<p><strong>^n</strong> ：匹配开头为n的字符串<br><strong>n$</strong> ：匹配结尾为n的字符串</p>
<h3 id="3-和正则表达式搭配的函数"><a href="#3-和正则表达式搭配的函数" class="headerlink" title="3.和正则表达式搭配的函数"></a><strong>3.和正则表达式搭配的函数</strong></h3><ul>
<li>match</li>
<li>replace</li>
<li>test</li>
</ul>
<p><strong>3.1 match</strong></p>
<p>返回指定的值，<em>而非字符串的位置</em><br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abc 853 isaf98024 sfk'</span>;</span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/\d/</span>;</span><br><span class="line">alert(str.match(re));<span class="comment">//8</span></span><br></pre></td></tr></table></figure></p>
<p><strong>3.2 replace</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abc abc abc'</span>;</span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/a/g</span>;</span><br><span class="line">alert(str.replace(re,<span class="string">'0'</span>));<span class="comment">//0bc 0bc 0bc</span></span><br><span class="line"><span class="string">``</span><span class="string">` </span><br><span class="line"></span><br><span class="line">**3.3 test**</span><br><span class="line"></span><br><span class="line">只要string中有re满足的部分即会返回true</span><br><span class="line">`</span><span class="string">``</span> javascript</span><br><span class="line"><span class="comment">//只要string中有re满足的部分即会返回true</span></span><br><span class="line">re.test(string);</span><br></pre></td></tr></table></figure>
<h3 id="4-实例"><a href="#4-实例" class="headerlink" title="4.实例"></a><strong>4.实例</strong></h3><ul>
<li>邮箱校验</li>
<li>去除一段文字中的html标签</li>
</ul>
<p><strong>4.1 邮箱校验</strong></p>
<p>邮箱的拼写规则：英文/数字/下划线&nbsp;&nbsp;&nbsp;&nbsp;@&nbsp;&nbsp;&nbsp;&nbsp;英文/数字 &nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;英文<br>邮箱的正则表达式：/&nbsp;&nbsp;&nbsp;&nbsp;\w+&nbsp;&nbsp;&nbsp;&nbsp;@&nbsp;&nbsp;&nbsp;&nbsp;[a-z0-9]+&nbsp;&nbsp;&nbsp;&nbsp;\.&nbsp;&nbsp;&nbsp;&nbsp;[a-z]+&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;i</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/\w+@[a-z0-9]+\.[a-z]+/i</span>;</span><br><span class="line">re.test(<span class="string">'abc@bcd.com'</span>);<span class="comment">//true</span></span><br><span class="line">re.test(<span class="string">'abc@bcd.com啦啦啦'</span>);<span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>注意到第二次校验的邮箱并不符合格式要求，但是结果仍然返回true。这是因为test函数，只要string中有正则表达式满足的部分即会返回true。</p>
<p>对正则表达式限制首部和尾部，可以避免这一问题，此时只有string从第一个字符到最后一个字符完全匹配成功，才会返回true，修改后的正则表达式如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/^\w+@[a-z0-9]+\.[a-z]+$/i</span>;</span><br></pre></td></tr></table></figure>
<p><strong>4.2 去除一段文字中的html标签</strong></p>
<p>如下一段文字中，多次出现html标签，在这个例子中，我们用正则表达式匹配每个标签，方便进一步对标签做删除操作。</p>
<blockquote>
<p>&lt;p&gt; 正是盛夏时节，不比初春时的一片新绿，知道好日子才开始，所以明亮快活，眼前的绿是沉甸甸的，许是因为知道绚烂已到了顶，以后的日子只有每况愈下。一如我此时的心情。&lt;br&gt;&lt;br&gt;  十天前，我换灯泡时从梯子上摔下来，醒时已经是在这具身体前主人的床上了。据丫鬟说，我是从阁楼的楼梯上摔了下来，然后昏迷了一天一夜。&lt;br&gt; &lt;br&gt; </p>
</blockquote>
<p>取出html标签，即取出&lt;&gt;包裹的内容，于是又如下正则表达式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/&lt;.+&gt;/g</span>;</span><br></pre></td></tr></table></figure>
<p>但是此时取出的是上面完整的段落，造成这样的原因是<strong>正则表达式的贪婪性</strong>，即会取出满足表达式的尽可能长的字符串，于是从段首的“&lt;”开始，一直取到断尾的“&gt;”。</p>
<p>正则表达式中 .+ 描述的不准确，并不是“&lt;&gt;”中任何字符都可以出现，其自身就不可以出现，修改正则表达式为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/&lt;[^&lt;&gt;]+&gt;/g</span>;</span><br></pre></td></tr></table></figure>
<p>———————- 2016年5月16日更新 ———————-</p>
<h3 id="5-正则表达式中包含变量"><a href="#5-正则表达式中包含变量" class="headerlink" title="5.正则表达式中包含变量"></a><strong>5.正则表达式中包含变量</strong></h3><p>今天写正则的时候遇到一个问题，我希望得到的正则表达式是下面这样的，其中stations[i]是个字符串变量<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/.*stations[i]/</span>;</span><br></pre></td></tr></table></figure></p>
<p>然而这样写的结果，得到的正则真的是就是原样的 /.*stations[i]/，stations[i]被当成了一个字符串处理了，而不是变量。</p>
<p>找到的解决办法是使用JavaScript风格的书写方式，如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">".*"</span>+stations[i]);</span><br></pre></td></tr></table></figure></p>
<p>OK~就是这么简单！</p>
<hr>
<p><strong>参考资料：</strong></p>
<p><a href="http://bbs.zhinengshe.com/thread-1211-1-1.html" target="_blank" rel="external">智能社JavaScript视频教程-32.JS中的正则表达式</a><br><a href="http://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434499503920bb7b42ff6627420da2ceae4babf6c4f2000" target="_blank" rel="external">廖雪峰JavaScript教程-RegExp</a><br><a href="http://www.w3school.com.cn/jsref/jsref_obj_regexp.asp" target="_blank" rel="external">W3School-JavaScript RegExp 对象</a></p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/05/14/地图坐标体系介绍及其互转工具/" class="prev">PREV</a><a href="/2016/03/28/onclick/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2016 <a href="http://yoursite.com">Mia Wang</a></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>